function openAttachmentModal(n){var t=new Date;commonAttachmentUrl=url_attachmentModal+"&canEdit="+n+"&date="+t.getSeconds();$("#attachmentModalContent").load(commonAttachmentUrl);$("#attachmentModal").modal("show")}function closeAttachmentModal(){$("#attachmentModal").modal("hide")}function workflowRequest(){$("#workflowModalContent").load(url_RequestWorkFlow);$("#workflowModal").modal()}function ChangeRole(n){var i=JSON.parse(n.Value),t=i.roleID,r,u;sessionStorage.setItem("selectedRoleId",t);$("#hdDefaultRoleId").val(t);$("#hdRoleId").val(t);sessionStorage.removeItem("roleMenus");sessionStorage.setItem("selectedRoleTag",i.roleTag);r={userId:$("#hdUserId").val(),roleId:t};GlobalAjax({commandName:COMMON_COMMANDS.LIST_MENUS_BY_ROLE_ID,values:JSON.stringify(r),CallBack:GetMenus});u={RoleID:t,RoleTag:i.roleTag};$.post(url_ChangeRole,u,function(){window.location.href="/212_Tajheez/Home/Index"})}function GetUserRoles(n){var t=JSON.parse(n.Value);sessionStorage.setItem("userRoles",JSON.stringify(t));GlobalAjax({commandName:COMMON_COMMANDS.GET_USER_PROFILE_BY_ID,values:'{userId:"'+$("#hdUserId").val()+'"}',CallBack:GetUserProfile})}function GetUserProfile(n){var t=JSON.parse(n.Value);sessionStorage.setItem("userProfile",JSON.stringify(t[0]));PopulateUserInformation()}function PopulateUserInformation(){var r=JSON.parse(sessionStorage.getItem("userProfile")),i=JSON.parse(sessionStorage.getItem("userRoles")),n=$("#cmbRoles"),t;n.empty();_LANG=="ar-AE"?($.map(r,function(n){$("#username").text(n.nameAr);$("#userRank").text(n.rankAr+" "+n.employeeCode);$("#userUnit").text(n.unitNameAr)}),$.map(i,function(t){n.append($("<option />").val(t.roleID).text(t.roleNameAR))})):($.map(r,function(n){$("#username").text(n.nameEn);$("#userRank").text(n.rankEn+" "+n.employeeCode);$("#userUnit").text(n.unitNameEn)}),$.map(i,function(t){n.append($("<option />").val(t.roleID).text(t.roleNameEN))}));(sessionStorage.selectedRoleId==undefined||getUrlVars()=="impersonate")&&sessionStorage.setItem("selectedRoleId",n.val());t=sessionStorage.getItem("selectedRoleId");n.val(t);$.map(i,function(n){n.roleID==t&&sessionStorage.setItem("selectedRoleTag",n.roleTag)});sessionStorage.roleMenus==undefined||getUrlVars()=="impersonate"?GlobalAjax({commandName:COMMON_COMMANDS.LIST_MENUS_BY_ROLE_ID,values:'{userId:"'+$("#hdUserId").val()+'",roleId:"'+t+'"}',CallBack:GetMenus}):PopulateMenus()}function GetMenus(n){var t=JSON.parse(n.Value);sessionStorage.setItem("roleMenus",JSON.stringify(t));PopulateMenus()}function PopulateMenus(){var t=JSON.parse(sessionStorage.getItem("roleMenus")),n='<ul class="MenuDirection">';_LANG=="ar-AE"?($.map(t,function(t){n=n+'<li class="menuItem"><a href="'+t.menuURL+'" data-parent="'+t.parentId+'" data-url="'+t.menuURL+'" data-menucode="'+t.menuCode+'"  onclick="menuClick(this)" class="AccordionBtn"><i class="'+t.menuImageAR+'"><\/i>   '+t.menuDescrAR+"<\/a><\/li>"}),n=n+"<\/ul>"):($.map(t,function(t){n=n+'<li class="menuItem"><a href="'+t.menuURL+'" data-parent="'+t.parentId+'" data-url="'+t.menuURL+'" data-menucode="'+t.menuCode+'"  onclick="menuClick(this)" class="AccordionBtn"><i class="'+t.menuImageEN+'"><\/i>   '+t.menuDescrEN+"<\/a><\/li>"}),n=n+"<\/ul>");PopulateSubMenus()}function menuClick(n){var i=$(n).data("menucode"),r=$(n).data("parent"),t;sessionStorage.setItem("selectedMenuCode",$(n).data("menucode"));t=$(n).data("url");r>0||t=="#"?(sessionStorage.setItem("IsSubMenuSelected",1),$("#subMenuBar").show()):(sessionStorage.setItem("IsSubMenuSelected",0),$("#subMenuBar").hide());t=="#"&&GlobalAjax({commandName:COMMON_COMMANDS.LIST_MENUS_BY_PARENT_ID,values:'{parentId:"'+i+'"}',CallBack:GetSubMenus})}function GetSubMenus(n){var t=JSON.parse(n.Value);sessionStorage.setItem("subMenus",JSON.stringify(t));PopulateSubMenus()}function PopulateSubMenus(){var t=JSON.parse(sessionStorage.getItem("subMenus")),n;$("#subMenuList").empty();n='<ul class="MenuDirection">';_LANG=="ar-AE"?($.map(t,function(t){n=n+'<li class="menuItem"><a href="'+t.menuURL+'"  data-parent="'+t.parentId+'" data-url="'+t.menuURL+'" data-menucode="'+t.menuCode+'"  onclick="menuClick(this)" class="AccordionBtn"><i class="'+t.menuImageAR+'"><\/i>   '+t.menuDescrAR+"<\/a><\/li>"}),n=n+"<\/ul>"):($.map(t,function(t){n=n+'<li class="menuItem"><a href="'+t.menuURL+'"  data-parent="'+t.parentId+'" data-url="'+t.menuURL+'" data-menucode="'+t.menuCode+'"  onclick="menuClick(this)" class="AccordionBtn"><i class="'+t.menuImageEN+'"><\/i>   '+t.menuDescrEN+"<\/a><\/li>"}),n=n+"<\/ul>")}function isNumberic(n){var t=n.target.value+n.key;isNaN(t)&&n.which!=8&&n.preventDefault()}var commonAttachmentUrl="";$(function(){sessionStorage.getItem("IsSubMenuSelected")==1;sessionStorage.IP==undefined&&GetClientIPAddress();sessionStorage.userProfile==undefined||getUrlVars()=="impersonate"?GlobalAjax({commandName:COMMON_COMMANDS.GET_USER_ROLES,values:'{userId:"'+$("#hdUserId").val()+'"}',CallBack:GetUserRoles}):PopulateUserInformation();$("#cmbRoles").on("change",function(){sessionStorage.setItem("IsSubMenuSelected",0);var n={};n.roleid=$(this).val();GlobalAjax({commandName:COMMON_COMMANDS.GET_USER_ROLES_BY_ID,values:JSON.stringify(n),CallBack:ChangeRole})});$("#workflowModal").on("show.bs.modal",function(){$(this).addClass("display-block")});$("#workflowModal").on("hide.bs.modal",function(){$(this).removeClass("display-block")})});